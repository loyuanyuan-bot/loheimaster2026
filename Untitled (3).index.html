<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æé±¼ç”Ÿè¾¾äºº - Lo Hei Master (Full Version)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&display=swap');
        
        body {
            background-color: #fffaf0;
            touch-action: none;
        }

        .chinese-font {
            font-family: 'Ma Shan Zheng', cursive, 'Noto Sans SC', sans-serif;
        }

        .ingredient-card {
            transition: all 0.2s ease;
            cursor: grab;
            border: 2px solid #fee2e2;
        }

        .ingredient-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            border-color: #f87171;
        }

        .drop-zone {
            transition: all 0.3s ease;
            min-height: 100px;
            border: 2px dashed #fca5a5;
            background-color: #fff1f1;
        }

        .drop-zone.drag-over {
            background-color: #fee2e2;
            border-color: #ef4444;
            transform: scale(1.02);
        }

        .matched {
            background-color: #f0fdf4 !important;
            border: 2px solid #4ade80 !important;
            animation: pulse 0.5s ease-out;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .yusheng-plate {
            background: radial-gradient(circle, #fff 60%, #fecaca 100%);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), inset 0 0 50px rgba(0,0,0,0.05);
        }

        .svg-icon {
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .on-plate {
            animation: dropIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        }

        @keyframes dropIn {
            0% { transform: scale(0) rotate(-45deg); opacity: 0; }
            100% { transform: scale(1) rotate(0); opacity: 1; }
        }

        /* Gemini Features Styling */
        .gemini-card {
            background: linear-gradient(135deg, #ffffff 0%, #fff5f5 100%);
            border: 2px solid #fecaca;
            border-radius: 1.5rem;
        }
    </style>
</head>
<body class="p-4 md:p-6 min-h-screen">

    <header class="text-center mb-8">
        <h1 class="text-4xl md:text-5xl font-bold text-red-600 chinese-font">æé±¼ç”Ÿè¾¾äºº</h1>
        <p class="text-lg text-red-800 font-semibold italic">Match the Ingredients to the Auspicious Phrases!</p>
        <div class="mt-4 flex justify-center gap-4">
            <span class="bg-red-600 text-white px-6 py-1 rounded-full text-sm font-bold shadow-md">
                è¿›åº¦ Progress: <span id="score">0</span> / 10
            </span>
        </div>
    </header>

    <div class="max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-12 gap-6">
        
        <!-- é£Ÿæåˆ—è¡¨ (å·¦ä¾§) -->
        <div class="lg:col-span-3 space-y-3 order-2 lg:order-1">
            <h2 class="text-xl font-bold text-orange-800 border-b-2 border-orange-200 pb-1">ğŸ é£Ÿæ Ingredients</h2>
            <div id="ingredients-list" class="grid grid-cols-2 lg:grid-cols-1 gap-3">
                <!-- é£Ÿæå°†é€šè¿‡ JS æ³¨å…¥ -->
            </div>
        </div>

        <!-- æ ¸å¿ƒåœ†ç›˜åŒºåŸŸ (ä¸­é—´) -->
        <div class="lg:col-span-6 flex flex-col items-center justify-start order-1 lg:order-2 pt-10">
            <div class="relative">
                <div class="yusheng-plate w-72 h-72 md:w-96 md:h-96 rounded-full border-[12px] border-yellow-600 flex items-center justify-center relative overflow-hidden shadow-2xl">
                    <div class="absolute inset-0 opacity-10" style="background-image: radial-gradient(#ef4444 2px, transparent 2px); background-size: 20px 20px;"></div>
                    <div id="plate-items" class="absolute inset-0 flex flex-wrap p-12 items-center justify-center pointer-events-none">
                        <span class="text-gray-300 opacity-40 text-2xl chinese-font text-center">æŠŠé£Ÿææ”¾è¿›æ¥ï¼<br>Place ingredients here!</span>
                    </div>
                </div>
                <!-- è£…é¥°æ€§ç­·å­ SVG -->
                <div class="absolute -top-10 -right-10 transform rotate(45deg) pointer-events-none">
                    <svg width="100" height="100" viewBox="0 0 100 100">
                        <line x1="20" y1="20" x2="80" y2="80" stroke="#7f1d1d" stroke-width="6" stroke-linecap="round"/>
                        <line x1="30" y1="10" x2="90" y2="70" stroke="#7f1d1d" stroke-width="6" stroke-linecap="round"/>
                        <rect x="20" y="20" width="10" height="10" fill="#f87171" transform="rotate(45 20 20)"/>
                    </svg>
                </div>
            </div>
            <p id="feedback" class="mt-8 h-12 text-red-600 font-bold text-xl text-center px-4"></p>
        </div>

        <!-- å‰ç¥¥è¯åˆ—è¡¨ (å³ä¾§) -->
        <div class="lg:col-span-3 space-y-3 order-3">
            <h2 class="text-xl font-bold text-orange-800 border-b-2 border-orange-200 pb-1">ğŸ§§ å‰ç¥¥è¯ Phrases</h2>
            <div id="phrases-list" class="space-y-3">
                <!-- å‰ç¥¥è¯å°†é€šè¿‡ JS æ³¨å…¥ -->
            </div>
        </div>
    </div>

    <!-- âœ¨ Gemini AI åŠŸèƒ½æ¿å— -->
    <div class="max-w-2xl mx-auto mt-16 p-6 gemini-card shadow-lg">
        <div class="flex items-center gap-3 mb-6">
            <div class="bg-red-600 p-2 rounded-lg">
                <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>
            </div>
            <h2 class="text-2xl font-bold text-red-700 chinese-font">é±¼ç”Ÿåˆ›æ„å¤§å¸ˆ âœ¨ AI Master</h2>
        </div>

        <!-- åŠŸèƒ½: å‰ç¥¥è¯ç”Ÿæˆå™¨ -->
        <div class="space-y-4">
            <h3 class="font-bold text-lg text-orange-800">ğŸ§§ è‡ªå®šä¹‰å‰ç¥¥è¯ Greeting Gen</h3>
            <div class="bg-orange-50 border-l-4 border-orange-400 p-4 rounded-r-xl">
                <p class="text-sm text-gray-700">
                    å‘Šè¯‰ AI ä½ çš„æ„¿æœ›ï¼Œå®ƒä¼šå¸®ä½ æ‰¾å‡ºç›¸åº”çš„é£Ÿæè”æƒ³èµ·æ¥ï¼<br>
                    <strong>å¦‚ï¼š</strong><br>
                    <span class="text-red-700">é¸¡ - å‰ç¥¥å¦‚æ„</span>
                </p>
            </div>
            <div class="flex gap-2 mt-4">
                <input type="text" id="wish-input" placeholder="è¾“å…¥å…³é”®å­—æˆ–æ„¿æœ›ï¼Œå¦‚ï¼šé¸¡ / è€ƒè¯•ç¬¬ä¸€..." class="flex-1 border-2 border-orange-200 rounded-xl px-4 py-2 focus:outline-none focus:border-red-400">
                <button onclick="generateGreeting()" id="gen-btn" class="bg-red-600 text-white px-4 py-2 rounded-xl font-bold hover:bg-red-700 transition-colors shrink-0">âœ¨ ç”Ÿæˆ</button>
            </div>
            <div id="greeting-result" class="min-h-[60px] p-3 bg-white/50 rounded-xl border border-orange-100 text-sm text-red-800 font-medium mt-2"></div>
        </div>
    </div>

    <!-- ğŸŒ å¯¼å‡ºä¸åˆ†äº«æ¿å— -->
    <div class="max-w-2xl mx-auto mt-8 mb-12 p-6 bg-white rounded-3xl border border-gray-200 shadow-sm">
        <div class="flex flex-col md:flex-row items-center justify-between gap-6">
            <div>
                <h3 class="text-lg font-bold text-gray-800">å¯¼å‡ºåº”ç”¨ Export App</h3>
                <p class="text-sm text-gray-500">å¤åˆ¶å®Œæ•´æºä»£ç ä»¥åœ¨å…¶ä»–åœ°æ–¹è¿è¡Œã€‚</p>
            </div>
            <div class="flex gap-3">
                <button onclick="copyFullCode()" class="flex items-center gap-2 bg-gray-800 text-white px-5 py-2 rounded-xl font-bold hover:bg-black transition-all">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/></svg>
                    å¤åˆ¶ä»£ç 
                </button>
            </div>
        </div>
        <div id="share-toast" class="hidden mt-4 p-3 bg-green-50 text-green-700 text-sm rounded-lg border border-green-200 text-center animate-pulse">
            ä»£ç å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼Code copied to clipboard!
        </div>
    </div>

    <!-- èƒœåˆ©å¼¹çª— -->
    <div id="win-modal" class="fixed inset-0 bg-black/80 hidden flex items-center justify-center z-50 p-4">
        <div class="bg-white rounded-3xl p-8 max-w-md w-full text-center border-4 border-yellow-400">
            <div class="text-7xl mb-4">ğŸ§§</div>
            <h2 class="text-4xl font-bold text-red-600 chinese-font mb-2">å‘å•Šï¼Huat Ah!</h2>
            <p class="text-gray-700 mb-6 font-bold">ä½ å®Œæˆäº†ä¸€ç›˜å®Œç¾çš„é±¼ç”Ÿï¼<br>You've prepared the perfect Yusheng!</p>
            <button onclick="location.reload()" class="bg-red-600 text-white font-bold py-3 px-8 rounded-full hover:bg-red-700 shadow-lg transition-transform active:scale-95">
                å†æ¥ä¸€ç›˜ Play Again
            </button>
        </div>
    </div>

    <script>
        const apiKey = ""; // è¿è¡Œæ—¶è‡ªåŠ¨æ³¨å…¥

        const svgIcons = {
            fish: `<svg viewBox="0 0 100 100"><path d="M10,50 Q30,20 60,35 T90,50 Q70,80 40,65 T10,50" fill="#ff9999" stroke="#b91c1c"/><path d="M65,40 Q75,45 85,40" fill="none" stroke="#b91c1c" stroke-width="2"/><circle cx="75" cy="45" r="2" fill="black"/></svg>`,
            pomelo: `<svg viewBox="0 0 100 100"><circle cx="50" cy="55" r="35" fill="#fde047" stroke="#a16207"/><path d="M50,20 Q55,10 60,20" fill="none" stroke="#166534" stroke-width="3"/><path d="M40,50 L60,50 M50,40 L50,60" stroke="#ca8a04" stroke-width="1" opacity="0.3"/></svg>`,
            spices: `<svg viewBox="0 0 100 100"><rect x="30" y="30" width="15" height="40" rx="2" fill="#e5e7eb" stroke="#374151"/><rect x="55" y="30" width="15" height="40" rx="2" fill="#d1d5db" stroke="#374151"/><path d="M30,35 H45 M55,35 H70" stroke="#374151" stroke-width="2"/></svg>`,
            oil: `<svg viewBox="0 0 100 100"><path d="M40,20 L60,20 L70,80 L30,80 Z" fill="#fef08a" stroke="#ca8a04"/><path d="M40,30 Q50,25 60,30" fill="none" stroke="#ca8a04" stroke-width="2" opacity="0.5"/></svg>`,
            carrots: `<svg viewBox="0 0 100 100"><path d="M20,40 L80,42 M20,50 L80,52 M20,60 L80,62" stroke="#ef4444" stroke-width="4" stroke-linecap="round"/><path d="M30,45 L70,47 M30,55 L70,57" stroke="#f87171" stroke-width="2" stroke-linecap="round"/></svg>`,
            greenRadish: `<svg viewBox="0 0 100 100"><path d="M20,40 L80,42 M20,50 L80,52 M20,60 L80,62" stroke="#22c55e" stroke-width="4" stroke-linecap="round"/><path d="M30,45 L70,47 M30,55 L70,57" stroke="#4ade80" stroke-width="2" stroke-linecap="round"/></svg>`,
            whiteRadish: `<svg viewBox="0 0 100 100"><path d="M20,40 L80,42 M20,50 L80,52 M20,60 L80,62" stroke="#cbd5e1" stroke-width="4" stroke-linecap="round"/><path d="M30,45 L70,47 M30,55 L70,57" stroke="#f1f5f9" stroke-width="2" stroke-linecap="round"/></svg>`,
            peanuts: `<svg viewBox="0 0 100 100"><circle cx="30" cy="40" r="5" fill="#d97706"/><circle cx="50" cy="45" r="5" fill="#b45309"/><circle cx="70" cy="40" r="5" fill="#d97706"/><circle cx="40" cy="65" r="5" fill="#b45309"/><circle cx="60" cy="60" r="5" fill="#d97706"/></svg>`,
            crackers: `<svg viewBox="0 0 100 100"><rect x="25" y="25" width="20" height="20" fill="#fbbf24" stroke="#b45309" transform="rotate(10)"/><rect x="55" y="30" width="20" height="20" fill="#f59e0b" stroke="#b45309" transform="rotate(-5)"/><rect x="40" y="55" width="20" height="20" fill="#fbbf24" stroke="#b45309" transform="rotate(15)"/></svg>`,
            plumSauce: `<svg viewBox="0 0 100 100"><path d="M35,30 Q50,20 65,30 L60,80 Q50,85 40,80 Z" fill="#991b1b" stroke="#450a0a"/><circle cx="50" cy="50" r="10" fill="#b91c1c" opacity="0.5"/></svg>`
        };

        const gameData = [
            { id: 1, name: 'ç”Ÿé±¼', pinyin: 'shÄ“ng yÃº', en: 'Raw Fish', phrase: 'å¹´å¹´æœ‰ä½™', phPinyin: 'niÃ¡n niÃ¡n yÇ’u yÃº', phEn: 'Abundance every year', key: 'fish' },
            { id: 2, name: 'æŸšå­', pinyin: 'yÃ²u zi', en: 'Pomelo', phrase: 'å¤§å‰å¤§åˆ©', phPinyin: 'dÃ  jÃ­ dÃ  lÃ¬', phEn: 'Good luck & prosperity', key: 'pomelo' },
            { id: 3, name: 'èƒ¡æ¤’ç²‰å’Œäº”é¦™ç²‰', pinyin: 'hÃº jiÄo fÄ›n hÃ© wÇ” xiÄng fÄ›n', en: 'Pepper & Five Spice Powder', phrase: 'æ‹›è´¢è¿›å®', phPinyin: 'zhÄo cÃ¡i jÃ¬n bÇo', phEn: 'Attract wealth & treasure', key: 'spices' },
            { id: 4, name: 'æ²¹', pinyin: 'yÃ³u', en: 'Oil', phrase: 'è´¢æºå¹¿è¿›', phPinyin: 'cÃ¡i yuÃ¡n guÇng jÃ¬n', phEn: 'Wealth flows in from all sides', key: 'oil' },
            { id: 5, name: 'çº¢èåœ', pinyin: 'hÃ³ng luÃ³ bo', en: 'Carrots', phrase: 'é¸¿è¿å½“å¤´', phPinyin: 'hÃ³ng yÃ¹n dÄng tÃ³u', phEn: 'Good luck is approaching', key: 'carrots' },
            { id: 6, name: 'é’èåœ', pinyin: 'qÄ«ng luÃ³ bo', en: 'Green Radish', phrase: 'é’æ˜¥æ°¸é©»', phPinyin: 'qÄ«ng chÅ«n yÇ’ng zhÃ¹', phEn: 'Eternal youth', key: 'greenRadish' },
            { id: 7, name: 'ç™½èåœ', pinyin: 'bÃ¡i luÃ³ bo', en: 'White Radish', phrase: 'æ­¥æ­¥é«˜å‡', phPinyin: 'bÃ¹ bÃ¹ gÄo shÄ“ng', phEn: 'Rising higher with every step', key: 'whiteRadish' },
            { id: 8, name: 'èŠéº»å’ŒèŠ±ç”Ÿç²‰', pinyin: 'zhÄ« mÃ¡ hÃ© huÄ shÄ“ng fÄ›n', en: 'Sesame Seeds & Peanuts', phrase: 'é‡‘é“¶æ»¡å±‹', phPinyin: 'jÄ«n yÃ­n mÇn wÅ«', phEn: 'House filled with gold & silver', key: 'peanuts' },
            { id: 9, name: 'è–„è„†é¥¼å¹²', pinyin: 'bÃ¡o cuÃ¬ bÇng gÄn', en: 'Golden Crackers', phrase: 'æ»¡åœ°é»„é‡‘', phPinyin: 'mÇn dÃ¬ huÃ¡ng jÄ«n', phEn: 'Floor covered with gold', key: 'crackers' },
            { id: 10, name: 'é…¸æ¢…é…±', pinyin: 'suÄn mÃ©i jiÃ ng', en: 'Plum Sauce', phrase: 'ç”œç”œèœœèœœ', phPinyin: 'tiÃ¡n tiÃ¡n mÃ¬ mÃ¬', phEn: 'Sweet and loving relationships', key: 'plumSauce' }
        ];

        let score = 0;
        let draggedId = null;

        // --- AI è°ƒç”¨é€»è¾‘ ---
        
        async function callGemini(prompt, systemInstruction) {
            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
            let retries = 0;
            const maxRetries = 5;

            const payload = {
                contents: [{ parts: [{ text: prompt }] }],
                systemInstruction: { parts: [{ text: systemInstruction }] }
            };

            while (retries < maxRetries) {
                try {
                    const response = await fetch(url, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });
                    const result = await response.json();
                    return result.candidates?.[0]?.content?.parts?.[0]?.text || "æŠ±æ­‰ï¼Œå‡ºäº†ä¸€ç‚¹å°é”™è¯¯ã€‚";
                } catch (e) {
                    retries++;
                    await new Promise(r => setTimeout(r, Math.pow(2, retries) * 1000));
                }
            }
            return "æ— æ³•è¿æ¥åˆ°AIæœåŠ¡å™¨ï¼Œè¯·ç¨åå†è¯•ã€‚";
        }

        async function generateGreeting() {
            const input = document.getElementById('wish-input').value;
            if (!input) return;
            
            const btn = document.getElementById('gen-btn');
            const resultDiv = document.getElementById('greeting-result');
            
            btn.disabled = true;
            btn.innerText = "ç”Ÿæˆä¸­...";
            resultDiv.innerText = "âœ¨ AI æ­£åœ¨æ„æ€å‰ç¥¥è¯...";

            const prompt = `ç”¨æˆ·è¾“å…¥æˆ–æ„¿æœ›: ${input}`;
            const system = "ä½ æ˜¯ä¸€ä¸ªæ–°åŠ å¡æé±¼ç”Ÿåˆ›æ„å¤§å¸ˆã€‚è¯·å°†ç”¨æˆ·çš„è¾“å…¥ï¼ˆå¦‚æ„¿æœ›æˆ–ç‰¹å®šå…³é”®å­—ï¼Œå¦‚ï¼šé¸¡ï¼‰ä¸æé±¼ç”Ÿçš„é£Ÿææˆ–è°éŸ³ç»“åˆï¼Œåˆ›ä½œä¸€æ®µæœ‰è¶£çš„ä¸­è‹±åŒè¯­å‰ç¥¥è¯ã€‚å¦‚æœç”¨æˆ·è¾“å…¥åŠ¨ç‰©æˆ–ç‰©å“ï¼Œè¯·æ‰¾å‡ºå…¶å‰ç¥¥çš„è°éŸ³å¹¶è”ç³»åˆ°é±¼ç”Ÿåˆ¶ä½œæ­¥éª¤ï¼ˆå¦‚ï¼šé¸¡è°éŸ³å‰ç¥¥ï¼Œå¯¹åº”çš„æ­¥éª¤æ˜¯æ”¾é±¼ä»£è¡¨å¹´å¹´æœ‰ä½™ï¼‰ã€‚è¦æ±‚ï¼šè¯­æ°”äº²åˆ‡å–œåº†ï¼Œå†…å®¹ç®€æ´æ˜“è¯»ã€‚";

            const result = await callGemini(prompt, system);
            resultDiv.innerText = result;
            btn.disabled = false;
            btn.innerText = "âœ¨ ç”Ÿæˆ";
        }

        // --- æ ¸å¿ƒæ¸¸æˆé€»è¾‘ ---

        function init() {
            const ingList = document.getElementById('ingredients-list');
            const phrList = document.getElementById('phrases-list');

            const shuffledIng = [...gameData].sort(() => Math.random() - 0.5);
            const shuffledPhr = [...gameData].sort(() => Math.random() - 0.5);

            shuffledIng.forEach(item => {
                const el = document.createElement('div');
                el.className = 'ingredient-card bg-white p-2 rounded-xl shadow-sm flex items-center gap-3 text-left';
                el.draggable = true;
                el.dataset.id = item.id;
                el.innerHTML = `
                    <div class="svg-icon bg-red-50 rounded-lg p-1 shrink-0">${svgIcons[item.key]}</div>
                    <div class="overflow-hidden">
                        <p class="font-bold text-red-700 leading-tight text-xs md:text-sm">${item.name}</p>
                        <p class="text-[9px] text-gray-500 italic">${item.pinyin}</p>
                        <p class="text-[9px] text-gray-400 font-bold uppercase truncate">${item.en}</p>
                    </div>
                `;
                el.addEventListener('dragstart', (e) => {
                    draggedId = item.id;
                    e.dataTransfer.setData('text/plain', item.id);
                    el.classList.add('scale-95', 'opacity-50');
                });
                el.addEventListener('dragend', () => el.classList.remove('scale-95', 'opacity-50'));
                ingList.appendChild(el);
            });

            shuffledPhr.forEach(item => {
                const el = document.createElement('div');
                el.className = 'drop-zone rounded-xl p-3 flex flex-col justify-center items-center text-center relative';
                el.dataset.id = item.id;
                el.innerHTML = `
                    <p class="chinese-font text-lg font-bold text-red-600">â€œ${item.phrase}â€</p>
                    <p class="text-[10px] text-red-400 font-semibold">${item.phPinyin}</p>
                    <p class="text-[9px] text-gray-500 italic px-1 leading-tight">${item.phEn}</p>
                    <div class="mt-2 text-[9px] text-gray-300 font-bold uppercase placeholder-text">æ‹–åŠ¨é£Ÿæåˆ°æ­¤å¤„</div>
                `;

                el.addEventListener('dragover', (e) => { e.preventDefault(); el.classList.add('drag-over'); });
                el.addEventListener('dragleave', () => el.classList.remove('drag-over'));
                el.addEventListener('drop', (e) => {
                    e.preventDefault();
                    el.classList.remove('drag-over');
                    const id = parseInt(e.dataTransfer.getData('text/plain'));
                    handleDrop(id, item.id, el);
                });
                phrList.appendChild(el);
            });
        }

        function handleDrop(sId, tId, targetEl) {
            if (sId === tId) {
                if (targetEl.classList.contains('matched')) return;

                const data = gameData.find(d => d.id === sId);
                
                targetEl.classList.add('matched');
                targetEl.innerHTML = `
                    <div class="w-10 h-10 mb-1">${svgIcons[data.key]}</div>
                    <p class="chinese-font text-sm font-bold text-green-700">${data.phrase}</p>
                    <p class="text-[9px] text-green-600 font-bold">æ­£ç¡®ï¼CORRECT!</p>
                `;

                const source = document.querySelector(`.ingredient-card[data-id="${sId}"]`);
                source.classList.add('opacity-10', 'grayscale', 'pointer-events-none');
                source.draggable = false;

                const plate = document.getElementById('plate-items');
                if (score === 0) plate.innerHTML = '';
                
                const pItem = document.createElement('div');
                pItem.className = 'w-16 h-16 md:w-20 md:h-20 on-plate absolute';
                
                const angle = Math.random() * Math.PI * 2;
                const radius = Math.random() * 80;
                const x = Math.cos(angle) * radius;
                const y = Math.sin(angle) * radius;
                
                pItem.style.left = `calc(50% + ${x}px - 32px)`;
                pItem.style.top = `calc(50% + ${y}px - 32px)`;
                pItem.innerHTML = svgIcons[data.key];
                plate.appendChild(pItem);

                score++;
                document.getElementById('score').innerText = score;
                document.getElementById('feedback').innerHTML = `<div class="text-green-600">âœ… â€œ${data.phrase}â€</div><div class="text-sm text-gray-500 font-medium">${data.phEn}</div>`;
                
                if (score === 10) {
                    setTimeout(() => document.getElementById('win-modal').classList.remove('hidden'), 800);
                }
            } else {
                document.getElementById('feedback').innerHTML = `<div class="text-red-600">âŒ è¯·å†è¯•ä¸€æ¬¡ï¼Try again!</div>`;
                setTimeout(() => { if(document.getElementById('feedback').innerText.includes('âŒ')) document.getElementById('feedback').innerText = ""; }, 1500);
            }
        }

        function showToast() {
            const toast = document.getElementById('share-toast');
            toast.classList.remove('hidden');
            setTimeout(() => toast.classList.add('hidden'), 3000);
        }

        function copyFullCode() {
            const fullHtml = document.documentElement.outerHTML;
            const textarea = document.createElement('textarea');
            textarea.value = fullHtml;
            document.body.appendChild(textarea);
            textarea.select();
            document.execCommand('copy');
            document.body.removeChild(textarea);
            showToast();
        }

        window.onload = init;
    </script>
</body>
</html>